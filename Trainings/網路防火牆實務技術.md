# 網路安全攻防錄
```
1.防火牆
2.pfsense:安裝與設定

攻擊與防禦實務:metasploiable2
1.測試環境建置
2.攻擊與防禦實務
3.攻擊與防禦實務
4.攻擊與防禦實務
5.攻擊與防禦實務
```
# 參考資料
```
Designing and Implementing Linux Firewalls and QoS using netfilter, iproute2, NAT and L7-filter
Learn how to secure your system and implement QoS using real-world scenarios for networks of all sizes
Lucian Gheorghe
2006

Implementing Packet filtering, NAT, bandwidth shaping, packet prioritization using 
netfilter/iptables, iproute2, Class Based Queuing (CBQ) and Hierarchical Token Bucket (HTB); 
Designing and implementing 5 real-world firewalls and QoS scenarios ranging from small SOHO offices 
to a large scale ISP network that spans many cities; 
Building intelligent networks by marking, queuing, and prioritizing different types of traffic.
```
```
Chapter 2: Security Threats 41
Layer 1 Security Threats 

Layer 2 Security Threats 
MAC Attacks 
DHCP Attacks 
ARP Attacks 
STP and VLAN-Related Attacks 

Layer 3 Security Threats 
Packet Snifing 
IP Spooing 
Routing Protocols Attacks 
ICMP Attacks 
Teardrop Attacks 

Layer 4 Security Threats 
TCP Attacks 
UDP Attacks 
TCP and UDP Port Scan Attacks 

Layer 5, 6, and 7 Security Threats 
BIND Domain Name System (DNS) 
Apache Web Server 
Version Control Systems 
Mail Transport Agents (MTA) 
Simple Network Management Protocol (SNMP) 
Open Secure Sockets Layer (OpenSSL) 
Protect Running Services—General Discussion 
```
```
Linux iptables Pocket Reference
Firewalls, NAT & Accounting
Gregor N. Purdy
2004
```

# 範例學習
```
iptables -t nat -A PREROUTING -i eth1 -p tcp --dport 80 -j DNAT --to-destination 192.168.1.3:8080
```
```
-t nat ==> Operate on the nat table...
-A PREROUTING ==>  by appending the following rule to its PREROUTING chain.
-i eth1 ==> Match packets coming in on the eth1 network interface...
-p tcp ==> that use the tcp (TCP/IP) protocol
--dport 80 ==>  and are intended for local port 80.
-j DNAT ==> Jump to the DNAT target...
--to-destination  192.168.1.3:8080 ==> and change the destination address to 192.168.1.3 and destination port to 8080.
```
```
iptables defines five “hook points” in the kernel’s packet processing pathways: 
PREROUTING, INPUT, FORWARD, POSTROUTING and OUTPUT. 

[1]FORWARD ... that flow through a gateway computer, coming in one interface and going right back out another.
[2]INPUT ... just before they are delivered to a local process.
[3]OUTPUT ... just after they are generated by a local process.
[4]POSTROUTING ... just before they leave a network interface.
[5]PREROUTING ... just as they arrive from a network interface (after dropping any packets resulting from the interface being in promiscuous
mode and after checksum validation).

the hook points are defined in the kernel header file /usr/include/linux/netfilter_ipv4.h 
with names like NF_IP_FORWARD, NF_IP_LOCAL_{IN,OUT}, and NF_IP_ {PRE,POST}_ROUTING.


Built-in chains are attached to these hook points; you can add a sequence of rules for each hook point. 
Each rule represents an opportunity to affect or monitor packet flow.
```
```
Tables
iptables comes with three built-in tables: filter, mangle, and nat. 
Each is preconfigured with chains corresponding to one or more of the hook points

[1]nat 
Used with connection tracking to redirect connections for network address translation; typically based on source or destination addresses.
Its built-in chains are: OUTPUT, POSTROUTING, and PREROUTING.

[2]filter 
Used to set policies for the type of traffic allowed into, through, and out of the computer. 
Unless you refer to a different table explicitly, iptables operate on chains within this table by default. 
Its built-in chains are: FORWARD, INPUT, and OUTPUT.

[3]mangle 
Used for specialized packet alteration, such as stripping off IP options (as with the IPV4OPTSSTRIP target extension). 
Its built-in chains are: FORWARD, INPUT, OUTPUT, POSTROUTING, and PREROUTING.
```

# 其他參考

```
Linux Network Administrator’s Guide, 3rd Edition
Infrastructure, Services, and Security
Gregor N. Purdy, Terry Dawson, Tony Bautts
2005
```
